<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
    <!-- Font Awesome JS -->
    <script class="lazy" data-src="https://kit.fontawesome.com/0000000000.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="stelySheet/login.css">


    <title>User login </title>
</head>
<body>
    <!--main-->
    <div class="login-page">


      <h1>User Login</h1>
        <div class="form">
         
          <form action="/login" method="POST" id="loginForm">
            <input type="text" required id="userName" placeholder="username"/>


            <input type="password"  id="password" placeholder="password"/>

            <button value="login" onclick="validate()">login</button>
            
            <p><a href="forget.html">Forgot password?</a></p>


            <p>Don't have Account ?<a href="userReg.html">SignUp</a></p>
            
            <p >Sign in as a Doctor? <a href="doctorsign.html">SignIn</a></p>

            <p>Sign in as a Admin? <a href="adminReg.html">SignIn</a></p>
          </form>
        </div>
      </div>
    <!--main-->
    <!--javascript -->
    <!--script>
      const BASE_URL = `http://localhost:345`;
      function getHeaders() {
  // Return headers
  return new Headers({
    "Accept": "application/json",
    "Content-Type": "application/json",
    "Authorization": "Bearer " + getAccessToken()
  });
}
async function getDataAsync(url) {

// Requests will use the GET method and permit cross origin requests
const GET_INIT = { method: 'GET', credentials: 'include', 
headers: getHeaders(), mode: 'cors', cache: 'default' };
try {
    // Call fetch and await the respose
    // Initally returns a promise
    const response = await fetch(url, GET_INIT);
    const json = await response.json();

    return json;
  } catch (err) {
    console.log(err);
    return err;
  }
}


    </script-->
    
  
  
<!--script>
  document.addEventListener('DOMContentLoaded', () => {
       const email = localStorage.getItem('userName')
       const password = localStorage.getItem('password')

        console.log('post data', email, password)})

  fetch('http://localhost:235/Api/v1/user',{
    method:'post',
    headers: {
      'content-teyp': 'application/json'
    },
    body:JSON.stringify({
      name: 'user 1'
    })
      
  }).then(res =>{
    if(res.ok){console.log("not succesful")}
  })
  .then(dat => console.log(data))
  .catch(erroe => 
  console.log('invalid username and passwor'))


  function resetData () {
       document.getElementById('userName').value = ''
       document.getElementById('password').value = ''
    };
  
</script-->
    
   


    <script>
     
     document.addEventListener('DOMContentLoaded', () => {
       const email = localStorage.getItem('userName')
       const password = localStorage.getItem('password')

        console.log('post data', email, password)



        fetch(`http://localhost:345/Api/v1/user/signin`)
      .then(response => response.json())
      .then(customer => {
        console.log("dsfsfsdfsfsd",customer);
            localStorage.setItem("email", customer.data.email);
            localStorage.setItem("userid", customer.data._id);
            localStorage.setItem("username", customer.data.name);

            window.location.replace('index.html');
      },
      function (e) {
        alert('invalid username and passwor')
        console.log('ERROR: ', e)
      })
    
     // Reset FormData after Posting
     resetData();

     function resetData () {
       document.getElementById('userName').value = ''
       document.getElementById('password').value = ''
    };

  }); 
      </script>
    <!--javascript-->


    
    
  
</body>
</html>