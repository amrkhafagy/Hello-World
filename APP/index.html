<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
    <!-- Font Awesome JS -->
    <script class="lazy" data-src="https://kit.fontawesome.com/0000000000.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="stelySheet/style.css">


    <title>Booking Appointment</title>
</head>
<body>
    <!-- Navigation -->
    <nav  class="navbar navbar-expand-lg navbar-dark bg-dark static-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="#"> Medical Website Template</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive"
                aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarResponsive">
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item active">
                        <a class="nav-link" href="index.html">Home
                            <span class="sr-only">(current)</span>
                        </a>
                    </li>
                    
                    <li class="nav-item">
                        <a class="nav-link" href="appointmentLst.html">My Appointments</a>
                    </li>
  
                    <li class="nav-item">
                      <a onclick="logout()" class="nav-link" >Logout</a>
                  </li>
                  
                         
                    <li>

                      <a class="nav-item" id="hello" href="#" ></a>
                    </li>


                </ul>
            </div>
        </div>
    </nav>
     <!--main body -->
     
                           
     <section class="preloader">
        <div class="spinner">

             <span class="spinner-rotate"></span>

        </div>
   </section>
    
</section>
<section  id="appointment" class="container" data-stellar-background-ratio="3">
    <div class="content" >
         <div class="row">
            <div class="col-md-6 col-sm-6">
                <form id="appointment-form" role="form" method="post" action="appointment-form">
                    <div class="section-title wow fadeInUp" data-wow-delay="0.4s">
                          <h2><em><b>Make an appointment</b></em></h2>
                     </div>
                     <div class="wow fadeInUp" data-wow-delay="0.8s">




                        <div class="col-md-6 col-sm-6">
                             <label for="date">Select Date</label>
                             <input min="" type="date" name="date" id="date" value="" class="form-control">
                        </div>
                    </br>

                    <div class="col-md-6 col-sm-6">
                         <label for="select">Select Time</label>
                         <select class="form-control" id="time">
                              <option>10:00 AM</option>
                              <option>10:30 AM</option>
                              <option>11:00 AM</option>
                              <option>11:30 AM</option>
                              <option>12:00 AM</option>
                              <option>2:00 Pm</option>
                              <option>2:30 Pm</option>
                              <option>3:00 Pm</option>
                              <option>3:30 pm</option>
                              <option>4:00 Pm</option>
                         </select>
                    </div>

                    </br>
                    <div class="col-md-6 col-sm-6">
                         <label for="select">Select Doctor</label>
                         <select class="form-control" id="doctor">

                         </select>
                    </div>
                    </br>
                    <div class="col-md-12 col-sm-12">
                         <div>
                              <label for="Message">Additional Message</label>
                         </div>
                         <textarea class="form-control" id="message" rows="5" id="message" name="message"
                              placeholder="Message"></textarea> </br> </br>
                         <button type="submit"  id="cf-submit" name="submit"class="btn btn-secondary">Submit button
                          </button>
                    </div>
               </div>
          </form>
     </div>

</div>
</div>
</section>
<!--footer-->
<div class="container">
  <div class="content"></div>
    <footer class="row">
      <div class="sozial col-xs-12 col-sm-6 col-sm-push-6">
        <ul class="row">
          <li class="col-xs-6 col-sm-2">
            <a href="#">
              <img class="logo" src="https://cdn2.iconfinder.com/data/icons/black-white-social-media/32/online_social_media_facebook-128.png">
            </a>
          </li>
          <li class="col-xs-6 col-sm-2">
            <a href="#">
              <img class="logo" src="https://cdn2.iconfinder.com/data/icons/black-white-social-media/32/twitter_online_social_media-128.png">
            </a>
          </li>
          <li class="col-xs-6 col-sm-2">
            <a href="#">
              <img class="logo" src="https://cdn2.iconfinder.com/data/icons/black-white-social-media/32/instagram_online_social_media_photo-128.png">
            </a>
          </li>
          <li class="col-xs-6 col-sm-2">
            <a href="#">
              <img class="logo" src="https://cdn2.iconfinder.com/data/icons/black-white-social-media/32/online_social_media_google_plus-128.png">
            </a>
          </li>
        </ul>
      </div><!-- Ende Sozial media -->
      
      <div class="copyright col-xs-12 col-sm-3 col-sm-pull-6">
        <p> &copy; <em>Online Booking System</em> </p>
      </div><!-- Ende Copyright -->
      
      <div class="impressum col-xs-12 col-sm-3 col-sm-pull-6">
        <p> <EM>Booking made simple for you</EM> </p>
        <p> <em>So book now for <b>free</b></em>  </p>
      </div><!-- Ende Impressum -->
    </footer>


   <!--JavaScript-->
  
</script-->
   <script>
     document.addEventListener('DOMContentLoaded', () => {
      fetch('http://localhost:8080/Api/v1/user/getalldoctors')
      .then(response => response.json())
      .then(customer => {
        if (customer.data.length == 0) {

         }
        else {
          for (var i = 0; i < customer.data.length; i++) 
          {$("#doctor").append('<option>' + customer.data[i].name 
               + '</option>');}
        }

        
        
      }
      )
       function error (e) {
          alert('Error!')
          console.log('ERROR: ', e)
        }
    })
    
          
   </script>

   <script>
      var todaydate = new Date();
          var day = String(todaydate.getDate()).padStart(2, '0');
          var month = String(todaydate.getMonth() + 1).padStart(2, '0');
          var year = todaydate.getFullYear();
          todaydate = year + '-' + month + '-' + day;
          document.getElementById("date").min=todaydate;


          function logout() {
               localStorage.clear();
               window.location.replace('login.html');
          }

          document.addEventListener('DOMContentLoaded', () => {
            const user_name=Document.getElementById("Username")
            document.getElementById("hello").innerHTML=user_name;
            if (userid) {
                    alert("Please Login to Access..??");
                    window.location.replace('signup.html');
                  }

          });

          document.getElementById("appointment-form").addEventListener('submit', event => {
              // Prevent the form from submitting via the browser.

            event.preventDefault()
            ajaxPost()
           })


           function ajaxPost() {
               Username
                    const id = localStorage.getItem("Username");
                    const formData = {
                          date= document.getElementById('date').value= '',
                          time= document.getElementById('time').value = '',
                          doctor= document.getElementById('doctor').value = '',
                          comment= document.getElementById('comment').value = '',
                         user: id,
                         status: "pending"

                    }

                    console.log("post data", formData);


                    try {
        const response = await fetch('http://localhost:8080/Api/v1/user/book', {
          method: 'PUT', 
          credentials: 'same-origin',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(formData) 
        })
        await response.json()
        alert('Appointment Created Success')
        window.location.replace('login.html')
        console.log(customer);
        localStorage.setItem("Bid", customer.data._id)
      } catch (e) {
        alert('Error!')
        console.log('ERROR: ', e)
      }
     }
     
     function resetData () {
       document.getElementById('name').value = '';
       document.getElementById('email').value = '';
    };
    resetData ();


   </script>



     <!--JavaScript--> 








     
    
  
</body>
</html>